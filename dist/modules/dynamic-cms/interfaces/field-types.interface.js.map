{"version":3,"sources":["../../../../src/modules/dynamic-cms/interfaces/field-types.interface.ts"],"sourcesContent":["/**\r\n * Các kiểu dữ liệu field được hỗ trợ\r\n */\r\nexport enum FieldType {\r\n  TEXT = 'text',\r\n  TEXTAREA = 'textarea',\r\n  STRING = 'string',\r\n  NUMBER = 'number',\r\n  BOOLEAN = 'boolean',\r\n  DATE = 'date',\r\n  DATETIME = 'datetime',\r\n  EMAIL = 'email',\r\n  URL = 'url',\r\n  SELECT = 'select',\r\n  MULTI_SELECT = 'multi_select',\r\n  RADIO = 'radio',\r\n  CHECKBOX = 'checkbox',\r\n  FILE = 'file',\r\n  IMAGE = 'image',\r\n  JSON = 'json',\r\n  RICH_TEXT = 'rich_text',\r\n  REFERENCE = 'reference', // Liên kết đến collection khác\r\n  ARRAY = 'array',\r\n}\r\n\r\n/**\r\n * Cấu hình validation cho field\r\n */\r\nexport interface FieldValidation {\r\n  required?: boolean;\r\n  min?: number;\r\n  max?: number;\r\n  minLength?: number;\r\n  maxLength?: number;\r\n  pattern?: string;\r\n  enum?: string[];\r\n  customValidation?: string; // JavaScript code để validate\r\n}\r\n\r\n/**\r\n * Cấu hình cho field type SELECT/MULTI_SELECT\r\n */\r\nexport interface SelectOption {\r\n  label: string;\r\n  value: string | number;\r\n}\r\n\r\n/**\r\n * Loại relationship giữa các collection\r\n */\r\nexport enum RelationType {\r\n  ONE_TO_ONE = 'one_to_one', // 1-1: User -> Profile\r\n  ONE_TO_MANY = 'one_to_many', // 1-N: User -> Posts\r\n  MANY_TO_ONE = 'many_to_one', // N-1: Posts -> User (inverse của one_to_many)\r\n  MANY_TO_MANY = 'many_to_many', // N-N: Posts -> Tags\r\n}\r\n\r\n/**\r\n * Cấu hình cho field type REFERENCE\r\n */\r\nexport interface ReferenceConfig {\r\n  collection: string; // Tên collection được tham chiếu\r\n  displayField: string; // Field nào sẽ hiển thị khi populate\r\n  multiple?: boolean; // Có cho phép multiple references không\r\n  relationType?: RelationType; // Loại quan hệ\r\n  cascadeDelete?: boolean; // Xóa cascade khi parent bị xóa\r\n  inverseSide?: string; // Field name ở collection được reference (cho bidirectional)\r\n\r\n  // Populate configuration\r\n  autoPopulate?: boolean; // Tự động populate khi query\r\n  populateFields?: string[]; // Các field cần lấy từ referenced collection\r\n  populateDepth?: number; // Độ sâu populate (tránh circular reference)\r\n}\r\n\r\n/**\r\n * Định nghĩa một field trong schema\r\n */\r\nexport interface FieldDefinition {\r\n  name: string;\r\n  label: string;\r\n  type: FieldType;\r\n  description?: string;\r\n  defaultValue?: any;\r\n  validation?: FieldValidation;\r\n\r\n  // Cấu hình cho các field type đặc biệt\r\n  options?: SelectOption[]; // Cho SELECT, RADIO, MULTI_SELECT\r\n  referenceConfig?: ReferenceConfig; // Cho REFERENCE\r\n\r\n  // UI configuration\r\n  placeholder?: string;\r\n  helpText?: string;\r\n  showInList?: boolean; // Hiển thị trong danh sách hay không\r\n  showInForm?: boolean; // Hiển thị trong form hay không\r\n  sortable?: boolean;\r\n  searchable?: boolean;\r\n\r\n  // Field ordering\r\n  order?: number;\r\n}\r\n\r\n/**\r\n * Định nghĩa một collection (table) động\r\n */\r\nexport interface CollectionSchema {\r\n  _id?: string;\r\n  name: string; // Tên collection (slug)\r\n  displayName: string; // Tên hiển thị\r\n  description?: string;\r\n  icon?: string;\r\n\r\n  // Fields configuration\r\n  fields: FieldDefinition[];\r\n\r\n  // Collection settings\r\n  timestamps?: boolean; // Tự động tạo createdAt, updatedAt\r\n  softDelete?: boolean; // Dùng deletedAt thay vì xóa thật\r\n\r\n  // API configuration\r\n  enableApi?: boolean;\r\n  apiPath?: string; // Custom API path\r\n\r\n  // Permissions & Access Control\r\n  permissions?: {\r\n    create?: string[]; // Array of role names\r\n    read?: string[];\r\n    update?: string[];\r\n    delete?: string[];\r\n  };\r\n\r\n  // Metadata\r\n  createdBy?: string;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n  version?: number;\r\n}\r\n\r\n/**\r\n * Document động - dữ liệu thực tế của user\r\n */\r\nexport interface DynamicDocument {\r\n  _id?: string;\r\n  _collection: string; // Tên collection này thuộc về\r\n  _data: Record<string, any>; // Dữ liệu thực tế\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n  deletedAt?: Date | null;\r\n  createdBy?: string;\r\n  updatedBy?: string;\r\n}\r\n"],"names":["FieldType","RelationType"],"mappings":"AAAA;;CAEC;;;;;;;;;;;QACWA;eAAAA;;QA+CAC;eAAAA;;;AA/CL,IAAA,AAAKD,mCAAAA;;;;;;;;;;;;;;;;;;;;WAAAA;;AA+CL,IAAA,AAAKC,sCAAAA;;;;;WAAAA"}