{"version":3,"sources":["../../../../src/modules/auth/strategies/jwt.strategy.ts"],"sourcesContent":["import { Injectable, UnauthorizedException } from '@nestjs/common';\r\nimport { PassportStrategy } from '@nestjs/passport';\r\nimport { ExtractJwt, Strategy } from 'passport-jwt';\r\nimport { AuthService } from '../auth.service';\r\n\r\n@Injectable()\r\nexport class JwtStrategy extends PassportStrategy(Strategy) {\r\n  constructor(private authService: AuthService) {\r\n    super({\r\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\r\n      ignoreExpiration: false,\r\n      secretOrKey: process.env.JWT_SECRET || 'your-secret-key-change-this',\r\n    });\r\n  }\r\n\r\n  async validate(payload: any) {\r\n    const user = await this.authService.validateUser(payload.sub);\r\n\r\n    if (!user) {\r\n      throw new UnauthorizedException();\r\n    }\r\n\r\n    return {\r\n      userId: payload.sub,\r\n      email: payload.email,\r\n      userName: payload.userName,\r\n      role: payload.role,\r\n    };\r\n  }\r\n}\r\n"],"names":["JwtStrategy","PassportStrategy","Strategy","validate","payload","user","authService","validateUser","sub","UnauthorizedException","userId","email","userName","role","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","ignoreExpiration","secretOrKey","process","env","JWT_SECRET"],"mappings":";;;;+BAMaA;;;eAAAA;;;wBANqC;0BACjB;6BACI;6BACT;;;;;;;;;;AAGrB,IAAA,AAAMA,cAAN,MAAMA,oBAAoBC,IAAAA,0BAAgB,EAACC,qBAAQ;IASxD,MAAMC,SAASC,OAAY,EAAE;QAC3B,MAAMC,OAAO,MAAM,IAAI,CAACC,WAAW,CAACC,YAAY,CAACH,QAAQI,GAAG;QAE5D,IAAI,CAACH,MAAM;YACT,MAAM,IAAII,6BAAqB;QACjC;QAEA,OAAO;YACLC,QAAQN,QAAQI,GAAG;YACnBG,OAAOP,QAAQO,KAAK;YACpBC,UAAUR,QAAQQ,QAAQ;YAC1BC,MAAMT,QAAQS,IAAI;QACpB;IACF;IArBA,YAAY,AAAQP,WAAwB,CAAE;QAC5C,KAAK,CAAC;YACJQ,gBAAgBC,uBAAU,CAACC,2BAA2B;YACtDC,kBAAkB;YAClBC,aAAaC,QAAQC,GAAG,CAACC,UAAU,IAAI;QACzC,SALkBf,cAAAA;IAMpB;AAgBF"}