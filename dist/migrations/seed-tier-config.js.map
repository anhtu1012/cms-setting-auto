{"version":3,"sources":["../../src/migrations/seed-tier-config.ts"],"sourcesContent":["import { NestFactory } from '@nestjs/core';\r\nimport { AppModule } from '../app.module';\r\nimport { TierConfigService } from '../common/tier/tier-config.service';\r\n\r\n/**\r\n * Migration script ƒë·ªÉ seed tier configuration v√†o database\r\n *\r\n * Ch·∫°y b·∫±ng l·ªánh:\r\n * npm run build && node dist/migrations/seed-tier-config.js\r\n */\r\nasync function seedTierConfig() {\r\n  console.log('üöÄ Starting tier configuration seeding...');\r\n\r\n  const app = await NestFactory.createApplicationContext(AppModule);\r\n  const tierConfigService = app.get(TierConfigService);\r\n\r\n  try {\r\n    // Seed default tiers\r\n    await tierConfigService.seedDefaultTiers();\r\n\r\n    console.log('‚úÖ Tier configuration seeded successfully!');\r\n    console.log('\\nDefault tiers created:');\r\n    console.log('- free: 2 databases, 100 data/collection');\r\n    console.log('- basic: 5 databases, 1000 data/collection');\r\n    console.log('- premium: 20 databases, 10000 data/collection');\r\n    console.log('- enterprise: unlimited');\r\n\r\n    // Hi·ªÉn th·ªã t·∫•t c·∫£ tiers\r\n    const tiers = await tierConfigService.getAllTiers(true);\r\n    console.log('\\nAll tiers in database:');\r\n    tiers.forEach((tier) => {\r\n      console.log(\r\n        `  - ${tier.tierCode} (${tier.tierName}): ${tier.isActive ? 'Active' : 'Inactive'}`,\r\n      );\r\n    });\r\n  } catch (error) {\r\n    console.error('‚ùå Error seeding tier configuration:', error);\r\n    throw error;\r\n  } finally {\r\n    await app.close();\r\n  }\r\n}\r\n\r\n// Run migration\r\nseedTierConfig()\r\n  .then(() => {\r\n    console.log('\\n‚úÖ Migration completed successfully!');\r\n    process.exit(0);\r\n  })\r\n  .catch((error) => {\r\n    console.error('\\n‚ùå Migration failed:', error);\r\n    process.exit(1);\r\n  });\r\n"],"names":["seedTierConfig","console","log","app","NestFactory","createApplicationContext","AppModule","tierConfigService","get","TierConfigService","seedDefaultTiers","tiers","getAllTiers","forEach","tier","tierCode","tierName","isActive","error","close","then","process","exit","catch"],"mappings":";;;;sBAA4B;2BACF;mCACQ;AAElC;;;;;CAKC,GACD,eAAeA;IACbC,QAAQC,GAAG,CAAC;IAEZ,MAAMC,MAAM,MAAMC,iBAAW,CAACC,wBAAwB,CAACC,oBAAS;IAChE,MAAMC,oBAAoBJ,IAAIK,GAAG,CAACC,oCAAiB;IAEnD,IAAI;QACF,qBAAqB;QACrB,MAAMF,kBAAkBG,gBAAgB;QAExCT,QAAQC,GAAG,CAAC;QACZD,QAAQC,GAAG,CAAC;QACZD,QAAQC,GAAG,CAAC;QACZD,QAAQC,GAAG,CAAC;QACZD,QAAQC,GAAG,CAAC;QACZD,QAAQC,GAAG,CAAC;QAEZ,wBAAwB;QACxB,MAAMS,QAAQ,MAAMJ,kBAAkBK,WAAW,CAAC;QAClDX,QAAQC,GAAG,CAAC;QACZS,MAAME,OAAO,CAAC,CAACC;YACbb,QAAQC,GAAG,CACT,CAAC,IAAI,EAAEY,KAAKC,QAAQ,CAAC,EAAE,EAAED,KAAKE,QAAQ,CAAC,GAAG,EAAEF,KAAKG,QAAQ,GAAG,WAAW,YAAY;QAEvF;IACF,EAAE,OAAOC,OAAO;QACdjB,QAAQiB,KAAK,CAAC,uCAAuCA;QACrD,MAAMA;IACR,SAAU;QACR,MAAMf,IAAIgB,KAAK;IACjB;AACF;AAEA,gBAAgB;AAChBnB,iBACGoB,IAAI,CAAC;IACJnB,QAAQC,GAAG,CAAC;IACZmB,QAAQC,IAAI,CAAC;AACf,GACCC,KAAK,CAAC,CAACL;IACNjB,QAAQiB,KAAK,CAAC,yBAAyBA;IACvCG,QAAQC,IAAI,CAAC;AACf"}